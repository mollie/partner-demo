#!/bin/bash

set -a
source .env

function help() { ### Show the list of possible functions
  grep -E '^function.*?###' $0 | sed "s/^function //g" | sed "s/()/:/g" | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-12s\033[0m %s\n", $1, $2}'
}

function up() { ### build and start development environment
  docker-compose -f docker-compose-dev.yml up --build
}

function upd() { ### build and start development environment detached
  docker-compose -f docker-compose-dev.yml up --build --detach
}

function down() { ### stop development environment
  docker-compose -f docker-compose-dev.yml down
}

function logs() { ### show environment logs (optionally: mysql|php-fpm)
  docker-compose -f docker-compose-dev.yml logs ${1:-}
}

function exec() { ### stop development environment
  docker-compose -f docker-compose-dev.yml exec "$@"
}

function bash() { ### access a given container (php-fpm default)
  docker-compose -f docker-compose-dev.yml exec ${1:-php-fpm} bash
}

if [ "_$1" = "_" ]; then
  help
else
  "$@"
fi
